<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>UIZ Quiz</title>
  <script src="/quiz.js"></script>

  <style>
    html, body {
      margin: 0;
      padding: 0;
      min-height: 100vh;
      background: url('https://wallpaperaccess.com/full/14118154.png') center/cover no-repeat fixed;
      background-size: cover;
      overflow-x: hidden;
      overflow-y: auto;
    }

    body::before {
      content: "";
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.65);
      z-index: 0;
      pointer-events: none;
    }

    body * {
      position: relative;
      z-index: 1;
    }

    /*.container {
      position: fixed;
      top: 3vh;
      left: 40vw;
      border: solid rgba(255,255,255,1) 5px;
      transform-origin:center;
      transform: rotate(5deg);
      border-radius: 70px 30px 30px 70px;
      height: 15vh;
      width: 18vw;
      background: rgba(255, 255, 255, 0.1);
      box-shadow: 1px 1px 2px 15px rgba(255, 255, 255,0.3),
                  1px 1px 5px 20px rgba(255, 255, 255,0.2);
      animation: cont 2s ease-in-out 10;
    }

    .logo {
      position: relative;
      left: 10px;
      bottom: 10px;
      border-radius: 50%;
      border: solid rgb(255, 255, 255) 10px;
      padding: 10px;
      height: 15vh;
      width: 15vh;
      background: rgba(255, 255, 255, 0.05);
      box-shadow: 1px 1px 2px 5px rgba(255, 255, 255,0.5),
                  1px 1px 5px 10px rgba(255, 255, 255,0.4);
      animation: cont 2s ease-in-out 10;
    }

    .stick {
      position: relative;
      background-color: rgb(255, 255, 255);
      transform-origin: top;
      transform: rotate(-45deg);
      top: -3vh;
      left: 7vw;
      width: 1vw;
      height: 5vh;
      box-shadow:1px 1px 2px 5px rgba(255, 255, 255,0.9),
                 1px 1px 5px 10px rgba(255, 255, 255,0.8);
      animation: cont1 2s ease-in-out 10;
    }

    .uiz {
      position: relative;
      top: -30vh;
      left: 10vw;
      font-size: 5vw;
      color: white;
      text-shadow: 2px 2px 8px rgba(0, 0, 0, 0.9);
      transform-origin:center;
      transform: rotate(5deg);
      animation: cont2 2s ease-in-out 10;
    }*/

    .page {
      display: flex;
      flex-direction: column;
      height: 90vh;
      width: 20vw;
      background: rgba(255, 255, 255, 0.15);
      position: absolute;
      top: 3rem;
      float: left;
      left: 10px;
      border-radius: 10px;
      backdrop-filter: blur(10px);
      padding: 10px;
      box-sizing: border-box;
               /* pushes group downward */
  
 

    }

    .picker {
      display: flex;
      flex-direction: column;
      flex: 1; /* fill all space */
      gap: 10px;
    }

    .section {
      flex: 1;
  display: flex;
  flex-direction: column;
  gap: 5px;
  position: relative;
}

.drop {
  display: none;
  position: fixed; /* <-- instead of absolute */
  left: 12vw; /* adjust to align with your sidebar */
  background-color: rgba(0, 0, 0, 0.85);
  padding: 10px;
  border-radius: 5px;
  color: white;
  z-index: 999999; /* stays above everything */
  width: 15vw;
  box-shadow: 0 4px 10px rgba(0,0,0,0.4);
}


    

    .btn {
      background-color: rgba(255, 255, 255, 0.2);
      color: white;
      border: none;
      font-size: 1em;
      padding: 15px;
      cursor: pointer;
      transition: background 0.3s ease;
      z-index: 10;
    }

    .btn:hover {
      background-color: rgba(255, 255, 255, 0.3);
    }

    

    .opt {
      display: block;
      margin: 5px 0;
    }

    #button {
      position: relative;   
      top: 0vh;
      left: 0%;
      
      background-color: #31ffa9;
      color: white;
      height: 60px;
      width: 160px;
      border: none;
      border-radius: 10px;
      font-size: 1.2em;
      cursor: pointer;
      z-index: 9999;
      box-shadow: 0 0 15px rgba(49, 255, 169, 0.6);
      transition: background 0.3s ease, transform 0.2s ease;
    }
    #button:hover {
      background-color: #25c986;
      transform: scale(1.05);
    }

    .news {
      display: block;
      position: absolute;
      top: 45rem;
      width: 100%;
      max-width: 100vw;
      color: white;
      margin: 50px 0 0 0;
      background: rgba(255, 255, 255, 0.15);
      border-radius: 10px;
      backdrop-filter: blur(10px);
      padding: 20px;
      min-height: 400px;
      box-sizing: border-box;
    }

    @keyframes cont {0%,100% {border-color: rgba(255,255,255,1);} 50% {border-color: rgba(200,200,200,0.6);}}
    @keyframes cont1 {0%,100% {background-color: white;} 50% {background-color: #ccc;}}
    @keyframes cont2 {0%,100% {color: white;} 50% {color: #ddd;}}
    .feed{
        display: block;
      width: 100%;
      position: absolute;
      top: 75rem;
      max-width: 100vw;
      color: white;
      margin: 50px 0 0 0;
      background: rgba(255, 255, 255, 0.15);
      border-radius: 10px;
      backdrop-filter: blur(10px);
      padding: 20px;
      min-height: 400px;
      box-sizing: border-box;
    }
    .about {
      float: right;
      display:inline;
      width: 50%;
      height: 90%;
      max-width: 50vw;
      color: white;
      margin: 50px 0 0 0;
      background: rgba(255, 255, 255, 0.15);
      border-radius: 10px;
      backdrop-filter: blur(10px);
      padding: 20px;
      min-height: 400px;
      box-sizing: border-box;
      position: absolute;
      left: 35%;
    }
    .about h1 {
  font-size: 2rem;        /* larger heading */
  margin-bottom: 1rem;    
}

.about p {
  font-size: 1rem;     /* slightly larger paragraph text */
  line-height: 1.8;       /* more spacing between lines */
  margin-bottom: 1.5em;   /* spacing between paragraphs */
  word-wrap: break-word;  /* prevent overflow on long words */
}

    @media(max-width: 1160px){
      
      .drop {
  display: none;
  position: fixed; /* <-- instead of absolute */
  left: 12vw; /* adjust to align with your sidebar */
  background-color: rgba(0, 0, 0, 0.85);
  padding: 10px;
  border-radius: 5px;
  color: white;
  z-index: 999999; /* stays above everything */
  width: 30vw;
  box-shadow: 0 4px 10px rgba(0,0,0,0.4);
}
      .page {
      display: flex;
      flex-direction: column;
      height: 90vh;
      width: 90vw;
      
      background: rgba(255, 255, 255, 0.15);
      position: absolute;
      top: 3rem;
      float: left;
      left: 10px;
      border-radius: 10px;
      backdrop-filter: blur(10px);
      padding: 10px;
      box-sizing: border-box;
    }
    #button {
      position: relative;   
      top: 0vh;
      left: 0%;
      
      background-color: #31ffa9;
      color: white;
      height: 60px;
      width: 160px;
      position: relative;
      
      border: none;
      border-radius: 10px;
      font-size: 1.2em;
      cursor: pointer;
      z-index: 9999;
      box-shadow: 0 0 15px rgba(49, 255, 169, 0.6);
      transition: background 0.3s ease, transform 0.2s ease;
    }
    .about h1 {
    font-size: 1.5rem; /* smaller heading for mobile */
    margin-bottom: 0.8rem;
  }

  .about p {
    font-size: 1rem;    /* smaller text */
    line-height: 1;   /* tighter spacing */
    margin-bottom: 1em;
  }

    .about {
      float: right;
      display:inline;
      width: 100%;
      height: 90%;
      max-width: 100vw;
      color: white;
      margin: 50px 0 0 0;
      background: rgba(255, 255, 255, 0.15);
      border-radius: 10px;
      backdrop-filter: blur(10px);
      padding: 20px;
      min-height: 400px;
      box-sizing: border-box;
      position: absolute;
      left:0%;
      top: 45rem;
    }
    .feed{
        display: block;
      width: 100%;
      position: absolute;
      top: 120rem;
      max-width: 100vw;
      color: white;
      margin: 50px 0 0 0;
      background: rgba(255, 255, 255, 0.15);
      border-radius: 10px;
      backdrop-filter: blur(10px);
      padding: 20px;
      min-height: 400px;
      box-sizing: border-box;
    }
    .news {
      display: block;
      position: absolute;
      top: 90rem;
      width: 100%;
      max-width: 100vw;
      color: white;
      margin: 50px 0 0 0;
      background: rgba(255, 255, 255, 0.15);
      border-radius: 10px;
      backdrop-filter: blur(10px);
      padding: 20px;
      min-height: 400px;
      box-sizing: border-box;
    }
    }
    /* PROFILE BUTTON */
#profileBtn {
  position: fixed;
  top: 20px;
  right: 20px;
  background: #31ffa9;
  padding: 10px 15px;
  font-size: 20px;
  border-radius: 8px;
  cursor: pointer;
  color: black;
  z-index: 100000;
  transition: 0.2s;
}

#profileBtn:hover {
  transform: scale(1.1);
}

/* POPUP BACKDROP */
#profilePopup {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  background: rgba(0,0,0,0.7);
  backdrop-filter: blur(5px);
  z-index: 999999;
  justify-content: center;
  align-items: center;
}

/* POPUP BOX */
#popupContent {
  width: 350px;
  background: rgba(255,255,255,0.15);
  border-radius: 15px;
  padding: 25px;
  color: white;
  backdrop-filter: blur(15px);
  box-shadow: 0 0 20px rgba(0,0,0,0.4);
  position: relative;
}

#popupContent h2 {
  text-align: center;
  margin-bottom: 15px;
}

/* Close button */
#closePopup {
  position: absolute;
  top: 10px;
  right: 10px;
  background: transparent;
  color: white;
  font-size: 20px;
  border: none;
  cursor: pointer;
}
.stort{
  margin-top: auto;               /* pushes group downward */
  display: flex;
  flex-direction: column;
  align-items: center;            /* horizontal center */
  justify-content: center;        /* vertical center */
  width: 100%;
  gap: 1rem;
}
  </style>
</head>
<body>
  
<div id="profileBtn">ðŸ‘¤</div>


<div id="profilePopup">
  <div id="popupContent">
    <button id="closePopup">âœ–</button>

    <h2>Your Profile</h2>

    <p><b>Username:</b> <span id="p_username">Loading...</span></p>
    <p><b>Score:</b> <span id="p_score">Loading...</span></p>

    <p><b>Accuracy (Right / Wrong):</b>  
      <span id="p_accuracy">Loading...</span>
    </p>

    <p><b>Accuracy %:</b>  
      <span id="p_accuracy_percent">Loading...</span>
    </p>

    <!--<p><b>Time Spent:</b>  
      <span id="p_time">Loading...</span>
    </p>-->
  </div>
</div>

  <div class="about">
    <h1>About This App</h1>
  <p>Welcome to UIZ Quiz! This is a quiz app designed to test your knowledge in <b>Fundamentals, OOPS, and DSA</b> across programming languages. The questions are selected randomly, so the app is <b>not adaptive</b>. Each quiz session brings a new challenge!</p>

  <p>You have full control over your quiz: choose the <b>topic</b>, <b>difficulty level</b>, <b>number of questions</b>, and <b>time limit</b> before starting. Strategize wisely to score as high as possible before the timer runs out. Remember, each choice affects your performance and the results shown on the leaderboard.</p>

  <p>After completing the quiz, your results will be displayed on the <b>leaderboard</b>, helping you track your progress over time and compare yourself with other users. Consistency and practice are key to climbing higher!</p>

  <p>Feel free to explore different combinations of topics, levels, and time constraints to challenge yourself. The more quizzes you take, the better your understanding of concepts will become.</p>

  <p><b>Tip:</b> Donâ€™t forget to leave feedback in the feedback section after exploring the app. Your input helps improve the experience for everyone and guides future updates.</p>
  </div>
  <div class="container">
    <div class="logo"></div>
    <div class="stick"></div>
    <h1 class="uiz">UIZ</h1>
  </div>

  <div class="page">
    <div class="picker">

      <div class="section">
        <button class="btn" onclick="dropdown(this)">Choose Topic</button>
        <div class="drop">
          <input type="radio" name="topic" value="fundamentals" class="opt" checked> Fundamentals
          <input type="radio" name="topic" value="dsa" class="opt"> DSA
          <input type="radio" name="topic" value="oops" class="opt"> OOPS
        </div>
      </div>

      <div class="section">
        <button class="btn" onclick="dropdown(this)">Choose Difficulty Level</button>
        <div class="drop">
          <input type="radio" name="level" value="easy" class="opt" checked> Easy
          <input type="radio" name="level" value="moderate" class="opt"> Moderate
          <input type="radio" name="level" value="hard" class="opt"> Hard
        </div>
      </div>

      <div class="section">
        <button class="btn" onclick="dropdown(this)">Choose Number of Questions</button>
        <div class="drop">
          <input type="radio" name="chosen" value="10" class="opt" checked> 10
          <input type="radio" name="chosen" value="20" class="opt"> 20
          <input type="radio" name="chosen" value="30" class="opt"> 30
        </div>
      </div>

      <div class="section">
        <button class="btn" onclick="dropdown(this)">Choose Time Limit</button>
        <div class="drop">
          <input type="radio" name="time" value="15" class="opt" checked> 15 min
          <input type="radio" name="time" value="30" class="opt"> 30 min
          <input type="radio" name="time" value="60" class="opt"> 60 min
        </div>
      </div>

    </div>
<div class="stort">
  <button id="button" onclick="dostuff()">Start</button>
</div>
    
  </div>

  <div class="news">
    <h1>Whats New</h1>
   
<p>Weâ€™ve just added <b>1,000+ new questions</b> covering DSA, Fundamentals, and OOPS â€” so you can level up your skills like never before.</p>  

<p>More control for you: now you can pick exactly how many questions you want, how hard they should be, and even how much time you want to take. Whether you're up for a quick warm-up or a full-length challenge, it's all in your hands!</p>  

<p>Get ready for more quizzes, more challenge, and more ways to push your limits. Give it a try â€” and let us know your feedback after exploring the new content!</p>

  </div>
  <div class="feed">
  <h1>Feedback</h1>
  <textarea id="feedbackInput" placeholder="Share your thoughts..." rows="5" 
            style="width:100%;  border-radius:5px; border:none; resize:none;"></textarea>
  <br><br>
  <button id="sendFeedback" 
          style="background:#31ffa9; color:white; border:none; padding:10px 20px; border-radius:5px; cursor:pointer;">
    Submit Feedback
  </button>

  <div id="sentimentResult" style="margin-top:15px; color:white;"></div>
</div>
 <script type="module">
import { createClient } from 'https://esm.sh/@supabase/supabase-js';

// create Supabase client
const supabase = createClient(
  'https://ztnldcowmuhldurztvad.supabase.co',
  'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inp0bmxkY293bXVobGR1cnp0dmFkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQ0ODE0OTksImV4cCI6MjA3MDA1NzQ5OX0.6U_BxibjiCK6p1xMgFyCd1nokaCUoetU_qWwEQ_YkQE'
);

// expose globally if needed
window.supabase = supabase;

// Popup toggle
const profileBtn = document.getElementById("profileBtn");
const popup = document.getElementById("profilePopup");
const closePopup = document.getElementById("closePopup");

profileBtn.addEventListener("click", () => {
  popup.style.display = "flex";
  loadPopupProfile();
});
closePopup.addEventListener("click", () => popup.style.display = "none");

async function loadPopupProfile() {
  const { data: { user } } = await supabase.auth.getUser(); // use supabase instance
  if (!user) return;

  const { data: profiles } = await supabase
    .from('profiles')
    .select(`username, score, attempted, time_spent,
      easy_correct, easy_incorrect,
      moderate_correct, moderate_incorrect,
      hard_correct, hard_incorrect`)
    .eq("id", user.id)
    .single();

  if (!profiles) return;

  const totalCorrect = profiles.easy_correct + profiles.moderate_correct + profiles.hard_correct;
  const totalIncorrect = profiles.easy_incorrect + profiles.moderate_incorrect + profiles.hard_incorrect;
  const totalAttempts = totalCorrect + totalIncorrect;
  const accuracyPercent = totalAttempts === 0 ? 0 : ((totalCorrect / totalAttempts) * 100).toFixed(1);

  document.getElementById("p_username").textContent = profiles.username;
  document.getElementById("p_score").textContent = profiles.score;
  document.getElementById("p_accuracy").textContent = `${totalCorrect} / ${totalIncorrect}`;
  document.getElementById("p_accuracy_percent").textContent = accuracyPercent + "%";
  document.getElementById("p_time").textContent = (profiles.time_spent || 0) + " min";
}
</script>

<script type="module">
import { createClient } from "https://esm.sh/@supabase/supabase-js";

const base = createClient(
  'https://ztnldcowmuhldurztvad.supabase.co',
  'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inp0bmxkY293bXVobGR1cnp0dmFkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQ0ODE0OTksImV4cCI6MjA3MDA1NzQ5OX0.6U_BxibjiCK6p1xMgFyCd1nokaCUoetU_qWwEQ_YkQE'
);

const feedbackInput = document.getElementById("feedbackInput");
const sendFeedbackBtn = document.getElementById("sendFeedback");
const sentimentResult = document.getElementById("sentimentResult");

sendFeedbackBtn.addEventListener("click", async () => {
  const message = feedbackInput.value.trim();
  if (!message) {
    alert("Please write something!");
    return;
  }

  // Get current session
const { data: sessionData, error: sessionError } = await base.auth.getSession();
let username = "Guest";

if (sessionData?.session?.user) {
    const userId = sessionData.session.user.id;

    // fetch username from profiles table
    const { data: profile, error } = await base
      .from("profiles")
      .select("username")
      .eq("id", userId)
      .single();

    if (profile?.username) username = profile.username;
}


  const { error } = await base
    .from("feedback")
    .insert({ username, message });

  if (error) {
    console.error(error);
    alert("Failed to submit feedback! " + error.message);
    return;
  }

  feedbackInput.value = "";
  sentimentResult.textContent = "Thank you for your feedback!";
});

</script>


  <script src="./quiz.js"></script>

  <script>
    function dropdown(button) {
      const next = button.nextElementSibling;
      const isVisible = next.style.display === "block";
      document.querySelectorAll(".drop").forEach(d => d.style.display = "none");
      next.style.display = isVisible ? "none" : "block";
    }
    

    function dostuff() {
      const topic = document.querySelector('input[name="topic"]:checked')?.value;
      const level = document.querySelector('input[name="level"]:checked')?.value;
      const chosen = document.querySelector('input[name="chosen"]:checked')?.value;
      const time = document.querySelector('input[name="time"]:checked')?.value;

      localStorage.setItem("subject", topic);
      localStorage.setItem("level", level);
      localStorage.setItem("numofques", chosen);
      localStorage.setItem("time", time);

      console.log("Starting quiz with:", { topic, level, chosen, time });
      
      window.location.href = "breeds.html";

    }
  </script>

</body>
</html>
